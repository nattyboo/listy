<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Cart Tracker</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;700;800&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0f1a0f;
    --surface: #172017;
    --surface2: #1e2d1e;
    --accent: #7fff5f;
    --accent-dim: #4db83a;
    --danger: #ff5f5f;
    --warn: #ffd15f;
    --text: #e8f5e8;
    --muted: #6a8a6a;
    --border: #2a3d2a;
    --radius: 16px;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Mono', monospace;
    min-height: 100dvh;
    max-width: 430px;
    margin: 0 auto;
    position: relative;
    overflow-x: hidden;
  }
  
  /* Header */
  .header {
    background: var(--surface);
    border-bottom: 1px solid var(--border);
    padding: 18px 20px 14px;
    position: sticky;
    top: 0;
    z-index: 100;
  }
  .header-top {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 14px;
  }
  .app-title {
    font-family: 'Syne', sans-serif;
    font-size: 22px;
    font-weight: 800;
    color: var(--accent);
    letter-spacing: -0.5px;
    line-height: 1;
  }
  .app-sub {
    font-size: 10px;
    color: var(--muted);
    letter-spacing: 1.5px;
    text-transform: uppercase;
    margin-top: 2px;
  }
  .budget-edit-btn {
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--muted);
    font-family: 'DM Mono', monospace;
    font-size: 11px;
    padding: 6px 12px;
    border-radius: 8px;
    cursor: pointer;
    letter-spacing: 0.5px;
  }
  .budget-edit-btn:active { opacity: 0.7; }

  /* Budget bar */
  .budget-section {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 8px;
    margin-bottom: 12px;
  }
  .stat-box {
    background: var(--surface2);
    border-radius: 10px;
    padding: 8px 10px;
    text-align: center;
  }
  .stat-label { font-size: 9px; color: var(--muted); letter-spacing: 1px; text-transform: uppercase; }
  .stat-value { font-family: 'Syne', sans-serif; font-size: 18px; font-weight: 700; margin-top: 2px; }
  .stat-value.green { color: var(--accent); }
  .stat-value.red { color: var(--danger); }
  .stat-value.warn { color: var(--warn); }

  .progress-bar-wrap {
    background: var(--surface2);
    border-radius: 6px;
    height: 8px;
    overflow: hidden;
  }
  .progress-bar-fill {
    height: 100%;
    border-radius: 6px;
    transition: width 0.4s cubic-bezier(.4,0,.2,1), background 0.3s;
    background: var(--accent);
  }
  .progress-bar-fill.warn { background: var(--warn); }
  .progress-bar-fill.over { background: var(--danger); }

  /* Tabs */
  .tabs {
    display: flex;
    gap: 6px;
    padding: 0 20px 0;
  }
  .tab {
    flex: 1;
    padding: 8px;
    text-align: center;
    font-family: 'Syne', sans-serif;
    font-size: 12px;
    font-weight: 700;
    letter-spacing: 0.5px;
    border-radius: 10px;
    cursor: pointer;
    color: var(--muted);
    background: transparent;
    border: none;
    transition: all 0.2s;
  }
  .tab.active {
    background: var(--accent);
    color: var(--bg);
  }
  .tab .count {
    display: inline-block;
    background: rgba(0,0,0,0.2);
    border-radius: 10px;
    padding: 1px 6px;
    font-size: 10px;
    margin-left: 4px;
  }

  /* Content */
  .content {
    padding: 16px 20px;
    padding-bottom: 120px;
  }

  /* Add item form */
  .add-form {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 14px;
    margin-bottom: 16px;
  }
  .form-row {
    display: flex;
    gap: 8px;
    align-items: center;
  }
  .input-wrap {
    flex: 1;
    position: relative;
  }
  input[type="text"], input[type="number"] {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    color: var(--text);
    font-family: 'DM Mono', monospace;
    font-size: 14px;
    padding: 10px 12px;
    outline: none;
    transition: border-color 0.2s;
    -webkit-appearance: none;
  }
  input[type="text"]:focus, input[type="number"]:focus {
    border-color: var(--accent);
  }
  input::placeholder { color: var(--muted); }
  .price-input-wrap {
    width: 110px;
    position: relative;
  }
  .price-input-wrap::before {
    content: '$';
    position: absolute;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--muted);
    font-size: 14px;
    z-index: 1;
    pointer-events: none;
  }
  .price-input-wrap input { padding-left: 22px; }

  .add-btn {
    background: var(--accent);
    border: none;
    border-radius: 10px;
    color: var(--bg);
    font-family: 'Syne', sans-serif;
    font-weight: 700;
    font-size: 20px;
    width: 42px;
    height: 42px;
    cursor: pointer;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.15s;
  }
  .add-btn:active { transform: scale(0.93); }

  .form-hint { font-size: 10px; color: var(--muted); margin-top: 8px; letter-spacing: 0.5px; }

  /* Item list */
  .items-list { display: flex; flex-direction: column; gap: 8px; }
  .item-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 12px 14px;
    display: flex;
    align-items: center;
    gap: 12px;
    animation: slideIn 0.2s ease;
    position: relative;
    overflow: hidden;
  }
  @keyframes slideIn {
    from { opacity: 0; transform: translateY(-8px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .item-card.in-cart {
    border-color: var(--accent-dim);
  }
  .item-card.in-cart::before {
    content: '';
    position: absolute;
    left: 0; top: 0; bottom: 0;
    width: 3px;
    background: var(--accent);
    border-radius: 3px 0 0 3px;
  }

  .check-btn {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    border: 2px solid var(--border);
    background: transparent;
    cursor: pointer;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    color: transparent;
    font-size: 14px;
  }
  .check-btn.checked {
    background: var(--accent);
    border-color: var(--accent);
    color: var(--bg);
  }

  .item-info { flex: 1; min-width: 0; }
  .item-name {
    font-family: 'Syne', sans-serif;
    font-size: 15px;
    font-weight: 700;
    color: var(--text);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .item-card.in-cart .item-name { color: var(--accent); }
  .item-status {
    font-size: 10px;
    color: var(--muted);
    letter-spacing: 0.5px;
    margin-top: 1px;
  }

  .item-price-area {
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .item-price {
    font-family: 'Syne', sans-serif;
    font-size: 16px;
    font-weight: 700;
    color: var(--accent);
    min-width: 60px;
    text-align: right;
  }
  .item-price.no-price { color: var(--muted); font-size: 11px; font-family: 'DM Mono', monospace; font-weight: 400; }
  .price-edit-input {
    width: 80px;
    font-size: 15px !important;
    padding: 5px 8px !important;
    text-align: right;
  }

  .delete-btn {
    background: transparent;
    border: none;
    color: var(--muted);
    font-size: 16px;
    cursor: pointer;
    padding: 4px;
    line-height: 1;
    flex-shrink: 0;
    border-radius: 6px;
    transition: all 0.15s;
  }
  .delete-btn:active { color: var(--danger); background: rgba(255,95,95,0.1); }

  .empty-state {
    text-align: center;
    padding: 40px 20px;
    color: var(--muted);
  }
  .empty-icon { font-size: 40px; margin-bottom: 12px; }
  .empty-text { font-family: 'Syne', sans-serif; font-size: 16px; font-weight: 700; color: var(--muted); }
  .empty-sub { font-size: 12px; margin-top: 4px; }

  /* Modal */
  .modal-backdrop {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.7);
    z-index: 200;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    backdrop-filter: blur(4px);
  }
  .modal-backdrop.hidden { display: none; }
  .modal {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 24px;
    width: 100%;
    max-width: 340px;
  }
  .modal-title {
    font-family: 'Syne', sans-serif;
    font-size: 20px;
    font-weight: 800;
    color: var(--accent);
    margin-bottom: 6px;
  }
  .modal-sub { font-size: 12px; color: var(--muted); margin-bottom: 20px; }
  .modal-input-wrap { position: relative; margin-bottom: 16px; }
  .modal-input-wrap::before {
    content: '$';
    position: absolute;
    left: 14px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--muted);
    font-size: 18px;
    z-index: 1;
    pointer-events: none;
  }
  .modal-input {
    width: 100%;
    background: var(--surface2);
    border: 2px solid var(--accent);
    border-radius: 12px;
    color: var(--text);
    font-family: 'Syne', sans-serif;
    font-size: 28px;
    font-weight: 700;
    padding: 14px 14px 14px 34px;
    outline: none;
    -webkit-appearance: none;
  }
  .modal-btn {
    width: 100%;
    background: var(--accent);
    border: none;
    border-radius: 12px;
    color: var(--bg);
    font-family: 'Syne', sans-serif;
    font-weight: 800;
    font-size: 16px;
    padding: 14px;
    cursor: pointer;
    letter-spacing: 0.5px;
  }
  .modal-btn:active { opacity: 0.85; }

  /* Section header */
  .section-header {
    font-size: 10px;
    color: var(--muted);
    letter-spacing: 2px;
    text-transform: uppercase;
    margin-bottom: 10px;
    margin-top: 4px;
  }

  /* Divider */
  .divider { height: 1px; background: var(--border); margin: 14px 0; }
</style>
</head>
<body>

<!-- Budget Modal -->
<div class="modal-backdrop" id="budgetModal">
  <div class="modal">
    <div class="modal-title">Set Budget</div>
    <div class="modal-sub">How much are you spending today?</div>
    <div class="modal-input-wrap">
      <input class="modal-input" type="number" id="budgetInput" placeholder="0.00" step="0.01" min="0" inputmode="decimal">
    </div>
    <button class="modal-btn" onclick="setBudget()">Let's Shop ‚Üí</button>
  </div>
</div>

<div class="header">
  <div class="header-top">
    <div>
      <div class="app-title">üõí CartWatch</div>
      <div class="app-sub">Budget Tracker</div>
    </div>
    <button class="budget-edit-btn" onclick="openBudgetModal()">‚úè Budget</button>
  </div>

  <div class="budget-section">
    <div class="stat-box">
      <div class="stat-label">Budget</div>
      <div class="stat-value green" id="budgetDisplay">$0</div>
    </div>
    <div class="stat-box">
      <div class="stat-label">In Cart</div>
      <div class="stat-value" id="totalDisplay" style="color:var(--text)">$0.00</div>
    </div>
    <div class="stat-box">
      <div class="stat-label">Remaining</div>
      <div class="stat-value green" id="remainingDisplay">$0.00</div>
    </div>
  </div>

  <div class="progress-bar-wrap">
    <div class="progress-bar-fill" id="progressBar" style="width:0%"></div>
  </div>

  <div style="margin-top: 10px;">
    <div class="tabs">
      <button class="tab active" id="tab-list" onclick="switchTab('list')">
        List <span class="count" id="listCount">0</span>
      </button>
      <button class="tab" id="tab-cart" onclick="switchTab('cart')">
        Cart <span class="count" id="cartCount">0</span>
      </button>
    </div>
  </div>
</div>

<div class="content">
  <div class="add-form">
    <div class="form-row">
      <input type="text" id="itemName" placeholder="Item name..." maxlength="40">
      <div class="price-input-wrap">
        <input type="number" id="itemPrice" placeholder="0.00" step="0.01" min="0" inputmode="decimal">
      </div>
      <button class="add-btn" onclick="addItem()">+</button>
    </div>
    <div class="form-hint">Price is optional ‚Äî add it later when you see it in store</div>
  </div>

  <!-- List tab -->
  <div id="view-list">
    <div class="section-header">Shopping List</div>
    <div class="items-list" id="listItems"></div>
    <div class="empty-state hidden" id="listEmpty">
      <div class="empty-icon">üìù</div>
      <div class="empty-text">List is empty</div>
      <div class="empty-sub">Add items above to get started</div>
    </div>
  </div>

  <!-- Cart tab -->
  <div id="view-cart" style="display:none">
    <div class="section-header">In Cart</div>
    <div class="items-list" id="cartItems"></div>
    <div class="empty-state hidden" id="cartEmpty">
      <div class="empty-icon">üõí</div>
      <div class="empty-text">Cart is empty</div>
      <div class="empty-sub">Check items off your list as you shop</div>
    </div>
    <div id="cartSummarySection" style="display:none">
      <div class="divider"></div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:4px">
        <span style="font-size:12px;color:var(--muted);letter-spacing:1px;text-transform:uppercase">Subtotal</span>
        <span id="cartSubtotal" style="font-family:'Syne',sans-serif;font-size:20px;font-weight:800;color:var(--accent)">$0.00</span>
      </div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
        <span style="font-size:12px;color:var(--muted);letter-spacing:1px;text-transform:uppercase">Unpriced items</span>
        <span id="unpricedCount" style="font-size:13px;color:var(--muted)">0 items</span>
      </div>
    </div>
  </div>
</div>

<script>
let budget = 0;
let items = JSON.parse(localStorage.getItem('cartwatch_items') || '[]');
let currentTab = 'list';

// Load saved budget
const savedBudget = localStorage.getItem('cartwatch_budget');
if (savedBudget) {
  budget = parseFloat(savedBudget);
  document.getElementById('budgetModal').classList.add('hidden');
  updateDisplay();
}

function save() {
  localStorage.setItem('cartwatch_items', JSON.stringify(items));
  localStorage.setItem('cartwatch_budget', budget);
}

function openBudgetModal() {
  document.getElementById('budgetInput').value = budget || '';
  document.getElementById('budgetModal').classList.remove('hidden');
  setTimeout(() => document.getElementById('budgetInput').focus(), 100);
}

function setBudget() {
  const val = parseFloat(document.getElementById('budgetInput').value);
  if (!val || val <= 0) return;
  budget = val;
  save();
  document.getElementById('budgetModal').classList.add('hidden');
  updateDisplay();
}
document.getElementById('budgetInput').addEventListener('keydown', e => { if (e.key === 'Enter') setBudget(); });

function addItem() {
  const nameEl = document.getElementById('itemName');
  const priceEl = document.getElementById('itemPrice');
  const name = nameEl.value.trim();
  if (!name) { nameEl.focus(); return; }
  const price = priceEl.value ? parseFloat(priceEl.value) : null;
  items.unshift({ id: Date.now(), name, price, inCart: false });
  nameEl.value = '';
  priceEl.value = '';
  nameEl.focus();
  save();
  render();
}
document.getElementById('itemName').addEventListener('keydown', e => { if (e.key === 'Enter') document.getElementById('itemPrice').focus(); });
document.getElementById('itemPrice').addEventListener('keydown', e => { if (e.key === 'Enter') addItem(); });

function toggleCart(id) {
  const item = items.find(i => i.id === id);
  if (!item) return;
  item.inCart = !item.inCart;
  save();
  render();
}

function deleteItem(id) {
  items = items.filter(i => i.id !== id);
  save();
  render();
}

function updatePrice(id, val) {
  const item = items.find(i => i.id === id);
  if (!item) return;
  item.price = val ? parseFloat(val) : null;
  save();
  updateDisplay();
}

function switchTab(tab) {
  currentTab = tab;
  document.getElementById('view-list').style.display = tab === 'list' ? '' : 'none';
  document.getElementById('view-cart').style.display = tab === 'cart' ? '' : 'none';
  document.getElementById('tab-list').classList.toggle('active', tab === 'list');
  document.getElementById('tab-cart').classList.toggle('active', tab === 'cart');
}

function updateDisplay() {
  const cartItems = items.filter(i => i.inCart);
  const total = cartItems.reduce((s, i) => s + (i.price || 0), 0);
  const remaining = budget - total;
  const pct = budget > 0 ? Math.min((total / budget) * 100, 100) : 0;

  document.getElementById('budgetDisplay').textContent = '$' + budget.toFixed(0);
  document.getElementById('totalDisplay').textContent = '$' + total.toFixed(2);

  const remEl = document.getElementById('remainingDisplay');
  remEl.textContent = (remaining < 0 ? '-$' : '$') + Math.abs(remaining).toFixed(2);
  remEl.className = 'stat-value ' + (remaining < 0 ? 'red' : remaining < budget * 0.15 ? 'warn' : 'green');

  const bar = document.getElementById('progressBar');
  bar.style.width = pct + '%';
  bar.className = 'progress-bar-fill' + (pct > 100 ? ' over' : pct > 80 ? ' warn' : '');

  // Tab counts
  document.getElementById('listCount').textContent = items.filter(i => !i.inCart).length;
  document.getElementById('cartCount').textContent = cartItems.length;

  // Cart summary
  const unpriced = cartItems.filter(i => i.price === null).length;
  document.getElementById('cartSubtotal').textContent = '$' + total.toFixed(2);
  document.getElementById('unpricedCount').textContent = unpriced + ' item' + (unpriced !== 1 ? 's' : '');
  document.getElementById('cartSummarySection').style.display = cartItems.length > 0 ? '' : 'none';
}

function makeItemCard(item) {
  const div = document.createElement('div');
  div.className = 'item-card' + (item.inCart ? ' in-cart' : '');

  const checkBtn = document.createElement('button');
  checkBtn.className = 'check-btn' + (item.inCart ? ' checked' : '');
  checkBtn.innerHTML = '‚úì';
  checkBtn.onclick = () => toggleCart(item.id);

  const info = document.createElement('div');
  info.className = 'item-info';
  const nameEl = document.createElement('div');
  nameEl.className = 'item-name';
  nameEl.textContent = item.name;
  const statusEl = document.createElement('div');
  statusEl.className = 'item-status';
  statusEl.textContent = item.inCart ? 'in cart' : 'on list';
  info.appendChild(nameEl);
  info.appendChild(statusEl);

  const priceArea = document.createElement('div');
  priceArea.className = 'item-price-area';

  if (item.inCart) {
    // Editable price
    const pinput = document.createElement('input');
    pinput.type = 'number';
    pinput.className = 'price-edit-input';
    pinput.style.cssText = 'width:85px;text-align:right;font-size:15px;padding:5px 8px;background:var(--surface2);border:1px solid var(--border);border-radius:8px;color:var(--text);font-family:DM Mono,monospace;outline:none;-webkit-appearance:none;';
    pinput.placeholder = '0.00';
    pinput.step = '0.01';
    pinput.min = '0';
    pinput.inputMode = 'decimal';
    if (item.price !== null) pinput.value = item.price;
    pinput.addEventListener('change', () => updatePrice(item.id, pinput.value));
    pinput.addEventListener('focus', () => pinput.style.borderColor = 'var(--accent)');
    pinput.addEventListener('blur', () => pinput.style.borderColor = 'var(--border)');
    priceArea.appendChild(pinput);
  } else {
    const priceEl = document.createElement('div');
    priceEl.className = item.price !== null ? 'item-price' : 'item-price no-price';
    priceEl.textContent = item.price !== null ? '$' + item.price.toFixed(2) : 'no price';
    priceArea.appendChild(priceEl);
  }

  const delBtn = document.createElement('button');
  delBtn.className = 'delete-btn';
  delBtn.innerHTML = '‚úï';
  delBtn.onclick = () => deleteItem(item.id);

  div.appendChild(checkBtn);
  div.appendChild(info);
  div.appendChild(priceArea);
  div.appendChild(delBtn);
  return div;
}

function render() {
  const listContainer = document.getElementById('listItems');
  const cartContainer = document.getElementById('cartItems');
  listContainer.innerHTML = '';
  cartContainer.innerHTML = '';

  const listItems = items.filter(i => !i.inCart);
  const cartItems = items.filter(i => i.inCart);

  listItems.forEach(item => listContainer.appendChild(makeItemCard(item)));
  cartItems.forEach(item => cartContainer.appendChild(makeItemCard(item)));

  document.getElementById('listEmpty').classList.toggle('hidden', listItems.length > 0);
  document.getElementById('cartEmpty').classList.toggle('hidden', cartItems.length > 0);

  updateDisplay();
}

render();
</script>
</body>
</html>
